<!doctype html>
<html lang="en">
    <head>
        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <!-- Bootstrap CSS -->
        <!--<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">-->

        <title>Product Category</title>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
        <link rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.19.1/dist/bootstrap-table.min.css">

    </head>
    <body>
        <nav class="navbar navbar-expand-lg navbar-dark" style="background-color:#4527A0;" >

            <div class="container">
                <a class="navbar-brand" href="/">
                    <img src="/resources/static/css/logoo.png" alt="" width="30" height="30">
                </a>
                <a href="/" class="navbar-brand"> click<span class="text-warning">SHOP</span> </a>
                <div class="collapse navbar-collapse" id="navmenu" style="color:#f0ad4e;">                              
                    Product categories
                </div>
        </nav>


        <!-- ADD Modal -->

        <div class="modal fade" id="add" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">Insert New Category</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <form action="/productCategory/add" method="POST">      
                        <div class="modal-body">

                            <div class="mb-3">
                                <label for="name" class="form-label">Enter Category Name: </label>
                                <input type="text" name="name" class="form-control" id="name" placeholder="Enter name">

                            </div>
                            <div class="mb-3">
                                <label for="description" class="form-label">Enter Category Description: </label>
                                <input type="text" name="description" class="form-control" id="description" placeholder="Enter description">
                            </div>


                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                            <button type="submit"  class="btn-save btn-primary" value="Save" id="create-test">Save new category</button>
                        </div>
                    </form> 
                </div>
            </div>
        </div>


        <div  class="p-2 container-add" id="toolbar">
            <button id="add-test" class=" btn btn-warning float-right"style="margin:10px;" data-bs-toggle="modal" data-bs-target="#add" data-align="right">Add New Category</button>
        </div>

        <!-- EDIT Modal -->
        <div class="modal fade" id="edit" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">Insert New Category</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <form action="/productCategory/update/" method="put">
                        <div class="modal-body">


                            <div class="mb-3">
                                <label for="name" class="form-label">Edit Category Name: </label>
                                <input type="text" name="name" class="form-control" id="name" placeholder="Edit name">

                            </div>
                            <div class="mb-3">
                                <label for="description" class="form-label">Edit Category Description: </label>
                                <input type="text" name="description" class="form-control" id="description" placeholder="Edit description">
                            </div>


                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                            <button type="submit" class="btn btn-primary" onclick="load();" >Save changes</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>      

        <div align="center" class="container my-2">    
            <table align="center" id="productCategory"
                   data-toggle="table"
                   data-url="http://localhost:8080/productCategory/getproductCategory"
                   data-editable-url="http://localhost:8080/productCategory/productCategory/edit"
                   data-id-field="productCategories">

                <thead>
                    <tr>
                        <th data-field="idproductCategory" data-align="center">#</th>
                        <th data-field="name" data-align="center">Product Category Name</th>
                        <th data-field="description" data-align="center">Description</th>
                        <th data-field="operate" data-formatter="operateFormatter" data-events="operateEvents">Action</th>
                    </tr>
                </thead>

            </table>
            <!-- <div id="form">
                 <form action="" method="post" name="registration" class="register">
                     <fieldset>
                         <label for="name">Category name: </label>
                         <input name="name"/>
                         <label for="description">Description: </label>
                         <input name="description"/>
                 </form>
             </div>-->
        </div>

        <div class="card-footer text-muted"style="background-color:#4527A0;"></div>
        <!--<nav class="navbar navbar-expand-lg navbar-dark" >
                           <div class="container">
                               <div class="collapse navbar-collapse" id="navmenu">
                               </div>
                           </div>
                       </nav>-->

        <!-- -->
        <!-- Optional JavaScript; choose one of the two! -->

        <!-- Option 1: Bootstrap Bundle with Popper -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>

        <!-- Option 2: Separate Popper and Bootstrap JS -->
        <!--
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
        -->
        <script src="https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
        <!--<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>-->
        <script src="https://unpkg.com/bootstrap-table@1.19.1/dist/bootstrap-table.min.js"></script>
        <script>
                    var $table = $('table');
                    var $edit = $('edit');
                    function operateFormatter(value, row, index) {
                        return[
                            '<a  class="remove" href="javascript:void(0)"  title="Remove">',
                            '<i class="fa fa-trash"></i> ',
                            '</a>',

                            '<button id="addEditModal" title="Edit" class="btn edit" data-bs-toggle="modal" data-bs-target="#edit" data-align="right">',
                            '<i class="far fa-edit" ></i> ',
                            '</button>'

                        ].join('')
                    }


                    window.operateEvents = {
                        'click .remove': function (e, value, row) {

                            $.ajax({
                                type: "DELETE",
                                url: "/productCategory/delete/" + row.idproductCategory,
                                headers: {'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')},
                                success: function (content) {
                                    $('#alert').html(content)
                                    $('#productCategory').bootstrapTable('refresh')
                                },
                                error: function (error) {
                                    console.log(error + " " + JSON.stringify(row));
                                }
                            });

                        },

                        'click .edit': function (e, value, row) {
                            $.ajax({
                                type: "put",
                                url: "/productCategory/update/",
                                headers: {'X-CSRF-TOKEN': $('meta[name="csrf-token"]').attr('content')},
                                success: function (content) {
                                    $('#alert').html(content)
                                    $('#productCategory').bootstrapTable('refresh')
                                },
                                error: function (error) {
                                    console.log(error + " " + JSON.stringify(row));
                                }
                            });
                        }


                    }
                    $('#addEditModal').click(function () {

                    })


        </script>


    </body>
</html>
